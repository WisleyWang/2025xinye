## 技术报告
我们从数据增强，模型设计，微调策略三个方面来阐述主要技术创新点。

### 一、数据增强策略
为了提升模型在复杂图像条件下的鲁棒性与泛化能力，本项目设计并采用了多阶段、层次化的数据增强策略，涵盖了训练阶段的随机扰动增强、推理阶段的多视角增强与高频残差增强（SRMConv2d）。整体增强策略如下：

#### 1.1 训练阶段的数据增强
在训练阶段，我们采用了基于 Albumentations 框架的复合数据增强策略，结合几何扰动、噪声扰动、颜色扰动与图像压缩等多维手段，以显著提升模型的鲁棒性和对真实场景的泛化能力。

| 增强类型         | 方法                                                                  | 描述                          |
| ------------ | ------------------------------------------------------------------- | --------------------------- |
| **几何变换**     | `HorizontalFlip`、`Rotate`、`RandomScale`、`PadIfNeeded`               | 模拟视角、姿态、尺寸变化，提升模型的空间泛化能力    |
| **模糊与噪声扰动**  | `GaussianBlur`、`GaussNoise`                                         | 增强模型在图像模糊或含有传感器噪声等劣质图像下的鲁棒性 |
| **颜色扰动**     | `ToGray`、`HueSaturationValue`、`FancyPCA`、`RandomBrightnessContrast` | 增强对灰度、色彩失真、光照变化等条件的适应性      |
| **结构遮挡扰动**   | `CoarseDropout`                                                     | 模拟遮挡或图像缺失区域，增强局部判别能力（默认关闭）  |
| **分辨率与压缩扰动** | `IsotropicResize`、`ImageCompression`                                | 适配多分辨率图像输入，并增强模型对压缩伪影的抗干扰能力 |
| **尺寸对齐**     | `Resize`                                                            | 最终统一图像尺寸，适配网络输入要求           |


> 通过以上组合增强策略，训练图像能够更全面地模拟实际部署时可能遇到的复杂场景，如模糊、压缩、低光照、姿态变化等，从而显著提升模型在非理想条件下的判别能力与稳定性。
#### 1.2 推理阶段的数据增强
为了增强推理阶段的稳定性与结果一致性，采用了**多视角增强（Test-Time Augmentation）**策略。对每张输入图像生成 6 个视图，并分别进行预测：

  | 增强形式       |
 | ---------- |
| 原图         |
 | 顺时针旋转 90°  |
| 顺时针旋转 180° |
 | 顺时针旋转 270° |
 | 垂直翻转       |

### 1.3 高频纹理增强（SRMConv2d）
为了增强模型对伪造痕迹或细节纹理的敏感性，设计并引入了一个高频残差滤波模块 SRMConv2d，具体实现如下：

设计三组 5×5 的固定高通滤波核（包括 KB、KV 和二阶水平差分）；

利用 SRMConv2d_simple 模块，对标准化后的 RGB 图像执行滤波，提取高频残差信息；

输出结果拼接至原图通道，增强模型对纹理与异常细节的建模能力。
```
滤波前图像形状： [3, H, W]
滤波后图像形状： [3, H, W] （SRM残差）
通道拼接后形状： [6, H, W]
```
> SRM 高频增强能够显著提升模型在图像伪造检测、压缩图像识别等任务下的判别能力。

#### 1.4 通道拼接与输入构建
推理阶段，每个视图图像将经过以下通道扩展流程：

原始 RGB 图像 → [3, H, W]

经过 SRMConv2d 提取高频纹理 → [3, H, W]

拼接得到增强输入 → [6, H, W]

###  二、模型设计
为有效提升模型在图像伪造检测任务中的性能与鲁棒性，我们设计了两个异构主干模型，以最大程度保留预训练知识、增强伪造特征学习、提高模型泛化能力。
具体来说，我们使用了 ReplNet 和 Vistransfomer 作为基础模型，并分别进行了结构调整。
受到《Orthogonal Subspace Decomposition for Generalizable AI-Generated Image
Detection》 一文的启发，我们采用了`正交子空间分解`+`辅助分支构造` 的方法来提升模型的泛化能力。

#### 2.2 Transformer 模型：辅助注意力与正交分解融合
对于transfomer模型，可以直接试用正交分解的，但由于比赛方只能使用`ImageNet in1K`上预训练的模型，符合要求的权重和模型只有`vit_base_patch16_224.augreg_in1k` ,因此我们在结构上进行了改进和扩展。

- **添加辅助注意力分支**：在原 attention 输出的基础上，平行添加一个训练可更新的 attention 模块，仅对该辅助分支进行参数更新；
- **显式正交分解建模**：对输入特征在维度空间上进行显式正交划分，主空间用于保持预训练特征表达能力，辅空间用于学习伪造特征，从而提升泛化性；
- **训练阶段冻结原始注意力权重**：保留预训练模型在自然图像中的表现能力，冻结原有结构的权重和高置矩阵；

该思想与`LoRA`训练LLM相似，但`LoRA`是直接在原有模型上添加低秩矩阵，而我们的方法是在原有模型上增加独立 attention 通道，构建更丰富的融合路径，同时保持原通道的功能不受干扰。 从而增加了模型的复杂度，保留了预训练权重的知识，提升模型的泛化能力。

#### 2.3 CNN 模型：局部卷积空间的协同解耦

由于卷积神经网络难以直接进行子空间正交分解，我们在 ReplNet 架构的基础上采用了辅助分支解耦机制，用于模拟“主干冻结 + 辅分支学习”的思想：

- **主干保留特征能力**：主干卷积层保持原有结构与权重参数不变，用于提取真实图像的稳健语义特征；
- **辅支增强伪造细节学习**：在 con_ffn 等模块中添加 conv_bn 辅助分支，仅对该分支训练，用于捕捉伪造图像中的微结构异常；
- **解耦表示空间**：主分支关注 real pattern，辅助分支聚焦 fake pattern，形成类比于 Transformer 中正交空间划分的异构建模方式；
- **融合策略**：主辅分支的特征通过通道拼接或加权融合，共同参与最终分类。

该模块的核心目标在于引导模型在保留原有图像语义结构分布的同时，增强对伪造局部纹理的识别能力，避免过拟合特定伪造样本。

我们的方法主要核心思想：
AIGI 检测中的非对称性问题：原始训练容易导致模型过拟合训练集中有限的 fake 模式，造成特征空间维度压缩；

通过预训练知识保留丰富表示结构：冻结主结构部分（主空间），可防止迁移学习过程中知识遗忘或损坏；

通过新增分支学习伪造特征：将伪造检测建模为“对真实图像的微扰”，通过残差空间建模差异；


### 三、微调策略
在模型初步训练完成后，为进一步增强其对真实图像空间中异常样本（伪造特征）的识别能力，我们引入了自混合微调策略（Self-Blended Fine-tuning），该策略受到论文 《Detecting Deepfakes with Self-Blended Images》（CVPR 2022）中 SBI 方法的启发。

#### 3.1 Self-Blended Images 思想简述
SBI 方法提出了一种伪造样本构建思路：不依赖外部生成器，而是在真实图像的基础上局部增强（如遮挡、扰动、人脸拼接），合成出伪造特征空间中的“反例样本”。其核心目标在于：

- 拓展 fake 模式分布；

- 提升模型对伪造边界与模糊区域的敏感性；

- 避免过拟合特定 Deepfake 模式。

这一思想提供了一种灵活、无监督的微调机制，有助于模型从真实图像中“想象”伪造特征。

#### 3.2 我们的微调策略设计
在本项目中，我们基于 SBI 的思路，对预训练模型进行了轻量化微调，策略如下：

- **微调数据来源**：仅使用 验证集中的真实样本（`xy_val`），通过局部扰动生成伪造样本；

- **伪造增强方式**：包括局部遮挡、结构混合、纹理替换等增强方式，形成 SBI 风格 fake 图(局部替换和局部mix替换均有)；

- **训练轮次限制**：仅训练 1 个 epoch，避免模型陷入 SBI 所带来的局部伪造模式中；

- **冻结主干，仅调分支**：对于引入了辅助分支的模型，仅训练辅助分支或低秩通道部分，保持主干表达能力稳定；

利用 SBI fake 作为“近邻伪造反例”，推动模型在特征空间中拉远真实图像与其微扰版本的距离，形成更清晰的判别边界。

#### 3.3 泛化能力的提升逻辑
我们实验证明：轻微微调比大幅微调更能增强泛化性，其原因在于：
模型可以适度感知 fake 模式的变异结构（如真实图像中存在的边界模糊、局部错位）；
而过度训练则可能导致模型过拟合于 SBI 的合成策略，反而削弱其对真实未知伪造手法的识别能力；
1 epoch 的训练量能够在不破坏原有高维表达能力的前提下，将 SBI 样本push 到真实空间边缘，从而“压缩”真实类特征的边界，提升伪造判别精度。